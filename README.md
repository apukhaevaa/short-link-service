# ShortLinks Service



Это сервис по сокращению ссылок, разработанный с использованием FastAPI, SQLAlchemy и MySQL. Сервис позволяет пользователям создавать короткие ссылки, перенаправлять по ним, обновлять, удалять и получать аналитику. Администратор имеет расширенные права для управления пользователями и ссылками.



## Функциональные возможности



### 1. Сокращение ссылок



- **Создание короткой ссылки:**  

  Отправьте POST-запрос на `/links/shorten` с данными:

  - `original_url` — длинная ссылка, которую нужно сократить.

  - `custom_alias` (необязательно) — желаемый код короткой ссылки (должен быть уникальным).

  - `expires_at` (необязательно) — дата и время, когда ссылка должна истечь (формат ISO 8601).



- **Создание публичной короткой ссылки:**  

  POST-запрос на `/links/public` позволяет создать ссылку без привязки к пользователю, при этом можно передать дополнительный параметр `project` для группировки.



### 2. Перенаправление



- **Переход по короткой ссылке:**  

  GET-запрос на `/links/{short_code}` перенаправляет пользователя на оригинальный URL. Если клиент запрашивает JSON (Accept: application/json), то возвращается JSON с оригинальным URL вместо редиректа.



### 3. Управление ссылками



- **Обновление ссылки:**  

  PUT-запрос на `/links/{short_code}` позволяет изменить оригинальный URL по заданному короткому коду. Обновление доступно авторизованным пользователям.



- **Удаление ссылки:**  

  DELETE-запрос на `/links/{short_code}` позволяет удалить ссылку. Администратор может удалять любые ссылки, а обычный пользователь — только свои.



- **Получение статистики:**  

  GET-запрос на `/links/{short_code}/stats` возвращает информацию о ссылке: оригинальный URL, дату создания, количество переходов, дату последнего использования и, при наличии, дату истечения.



- **Поиск ссылки:**  

  GET-запрос на `/links/search/` с параметром `original_url` позволяет найти все ссылки с указанным оригинальным URL.



- **Получение устаревших ссылок:**  

  GET-запрос на `/links/expired/` возвращает список ссылок, срок действия которых истёк.



### 4. Аутентификация и авторизация



- **Регистрация пользователя:**  

  POST-запрос на `/auth/register` позволяет зарегистрировать нового пользователя, указав `username` и `password`.



- **Получение токена:**  

  POST-запрос на `/auth/token` выполняет авторизацию и возвращает JWT-токен, который требуется для доступа к защищённым эндпоинтам (например, для создания, обновления или удаления ссылок).



- **Эндпоинт для получения данных текущего пользователя:**  

  GET-запрос на `/auth/me` (если реализовано) позволяет узнать, кто авторизован.



### 5. Административный интерфейс (Admin-panel)



- **Управление пользователями:**  

  Эндпоинты в разделе `/admin-panel` позволяют администратору:

  - Просматривать список всех пользователей.

  - Удалять пользователей (админ может удалять любого пользователя, при этом связанные ссылки автоматически обрабатываются через настройки каскадного удаления или соответствующую логику).



- **Управление ссылками:**  

  Админ-панель также позволяет просматривать и удалять ссылки, принадлежащие любому пользователю.



## Технологии



- **Backend:**  

  - [FastAPI](https://fastapi.tiangolo.com/) – высокопроизводительный веб-фреймворк.

  - [SQLAlchemy](https://www.sqlalchemy.org/) – ORM для работы с MySQL.

  - [Pydantic](https://pydantic-docs.helpmanual.io/) – валидация данных.

  - [JWT (python-jose)](https://github.com/mpdavis/python-jose) – аутентификация и авторизация.



- **Database:**  

  - MySQL – основное хранилище данных.



- **Frontend (шаблоны):**  

  - HTML, CSS, Bootstrap 5 – для создания адаптивного и современного интерфейса.




## Примеры использования (через Swagger)



- **Регистрация пользователя:**  

  Введите JSON:

  ```json

  {

    "username": "admin",

    "password": "123456"

  }

  ```

  и нажмите **"Try it out"**.



- **Получение токена:**  

  Заполните форму с `username` и `password` и получите JWT-токен.



- **Создание короткой ссылки:**  

  Введите:

  ```json

  {

    "original_url": "https://google.com",

    "custom_alias": "mygoogle2",

    "expires_at": "2025-12-31T23:59:00"

  }

  ```

  и нажмите **"Try it out"**.



- **Переход по короткой ссылке:**  

  Введите `mygoogle2` в параметр пути и выполните запрос. В браузере это выполнит редирект.



- **Обновление, удаление, статистика, поиск и получение устаревших ссылок:**  

  Тестируйте соответствующие эндпоинты, передавая необходимые параметры и получая JSON-ответы.



## Дополнительные настройки



- **Авторизация:**  

  Не забудьте нажать кнопку **"Authorize"** в Swagger и ввести токен в формате:

  ```

  Bearer <access_token>

  ```

  чтобы иметь доступ к защищённым эндпоинтам.



- **Каскадное удаление:**  

  В админ-панели удаление пользователей автоматически удаляет связанные ссылки (настроено через Foreign Key или ручная логика), чтобы избежать ошибок IntegrityError.



## Скриншоты сервиса

Рис. 1

